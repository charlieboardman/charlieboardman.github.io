<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>CFDI (ZIP of XML) → XLSX</title>
	<style>
		body {
			font-family: system-ui, sans-serif;
			margin: 2rem;
			max-width: 900px;
		}
		h1 {
			margin-top: 0;
		}
		.row {
			display: flex;
			gap: 1rem;
			align-items: center;
			flex-wrap: wrap;
		}
		#log {
			white-space: pre-wrap;
			background: #f6f6f6;
			padding: 1rem;
			border-radius: 8px;
			max-height: 40vh;
			overflow: auto;
		}
		button {
			padding: 0.6rem 1rem;
		}
		.muted {
			color: #666;
		}
		progress {
			width: 100%;
			height: 12px;
		}
	</style>
</head>
<body>
	<h1>CFDI ZIP → XLSX Converter (client-side)</h1>
	<p class="muted">
		Drop or select one or more <strong>.zip</strong> files (each containing
		CFDI XMLs). Nothing leaves your browser.
	</p>

	<div class="row">
		<input id="fileInput" type="file" accept=".zip" multiple />
		<button id="convertBtn">Convert to XLSX</button>
	</div>

	<p class="muted">Progress</p>
	<progress id="prog" max="100" value="0"></progress>

	<h3>Log</h3>
	<div id="log"></div>

	<!-- We'll add our JavaScript dependencies and code here step by step -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <script>
        const fileInput = document.getElementById('fileInput') //Get the file input element
        const convertBtn = document.getElementById('convertBtn') //Get the convert button
        const logDiv = document.getElementById('log') //Get the log area of the page

        function log(message) {
            logDiv.textContent += message+ '\n'           
        }

		convertBtn.addEventListener('click', function() { //When the convert button is pressed
			const files = fileInput.files //Grab the files that were inserted into the input
			log(`Selected ${files.length} files`)	

			for (let i = 0; i < files.length; i++) {
				const file = files[i]
				log(`File ${i + 1}: $file.name}`)
			}			
		
		});
	</script>

</body>
</html>

